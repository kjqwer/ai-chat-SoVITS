# FunASR 语音识别 - 快速开始指南

## 1. 安装依赖

### 方法一：使用runtime环境（推荐）
```bash
runtime\python.exe asr/install_runtime.py
```

### 方法二：自动安装（系统Python）
```bash
python asr/install_fix.py
```

### 方法三：手动安装
```bash
pip install -r asr/requirements_minimal.txt
pip install funasr
```

## 2. 启动服务

### 方法一：使用批处理文件（Windows）
双击运行 `启动ASR服务.bat`

### 方法二：手动启动
```bash
python GPT_SoVITS/backend_api.py
```

### 方法三：独立ASR服务器
```bash
python -m asr server --port 8001
```

## 3. 测试功能

### 验证安装
```bash
python asr/test_installation.py
```

### 测试API
```bash
# 健康检查
curl http://localhost:8000/asr/health

# 获取模型信息
curl http://localhost:8000/asr/model/info

# 加载模型
curl -X POST http://localhost:8000/asr/model/load
```

### 测试音频识别
```bash
# 使用命令行工具
python -m asr test audio.wav

# 或直接使用CLI
python asr/cli.py audio.wav
```

## 4. 使用API

### 上传文件识别
```bash
curl -X POST "http://localhost:8000/asr/recognize/file" \
     -H "Content-Type: multipart/form-data" \
     -F "audio_file=@your_audio.wav"
```

### WebSocket实时识别
```javascript
const ws = new WebSocket('ws://localhost:8000/asr/ws');

// 加载模型
ws.send(JSON.stringify({
    type: 'config',
    load_model: true
}));

// 发送音频数据
ws.send(JSON.stringify({
    type: 'audio_data',
    data: base64AudioData,
    format: 'wav'
}));
```

## 5. 配置管理

### 查看当前配置
```bash
python -m asr config --show
```

### 重置配置
```bash
python -m asr config --reset
```

### 环境变量配置
```bash
# 设置模型名称
set ASR_MODEL_NAME=your-model-name

# 设置设备
set ASR_DEVICE=cuda

# 设置采样率
set ASR_SAMPLE_RATE=16000
```

## 6. 常见问题

### Q: FunASR安装失败
A: 
1. 检查Python版本（需要3.8+）
2. 更新pip: `pip install --upgrade pip`
3. 尝试从源码安装: `pip install git+https://github.com/alibaba-damo-academy/FunASR.git`

### Q: 模型加载失败
A:
1. 检查网络连接
2. 确保有足够的存储空间
3. 检查模型名称是否正确

### Q: 音频识别失败
A:
1. 检查音频文件格式（支持wav,mp3,m4a,flac,aac,ogg）
2. 确认音频质量和长度
3. 检查模型是否已加载

## 7. API文档

启动服务后访问: http://localhost:8000/docs

## 8. 支持的音频格式

- WAV (.wav)
- MP3 (.mp3) 
- M4A (.m4a)
- FLAC (.flac)
- AAC (.aac)
- OGG (.ogg)

## 9. 获取帮助

```bash
# 查看所有命令
python -m asr --help

# 查看特定命令帮助
python -m asr test --help
python -m asr server --help
```

详细文档请参考 `asr/README.md` 